# ChangeLog for Portage; the Gentoo Linux ports system 
# Copyright 2002 Gentoo Technologies, Inc.; Distributed under the GPL

  21 Feb 2002; Daniel Robbins <drobbins@gentoo.org> ebuild.sh, portage.py:
  Dependencies should be no longer checked during the "unpack" stage.  This
  closes bug #231.  Added the $KV kernel version variable to ebuild.sh so
  that it's available for all ebuilds.  This closes bug #599.
  
  21 Feb 2002; Daniel Robbins <drobbins@gentoo.org> ebuild.sh: S now defaults
  to ${WORKDIR}/${P} if it isn't defined.  That's right.  Defining S is now 
  optional :)  This should eliminate around 1000 lines from our ports tree.
  
  20 Feb 2002; Daniel Robbins <drobbins@gentoo.org> portage.py: Fixed some
  major bugs in the new merge/config protect code.  Merging and config
  protection should now work.
  
  18 Feb 2002; Daniel Robbins <drobbins@gentoo.org> portage.py, emerge,
  ebuild.sh : Rewrote merge code.  Should merge symlinks only *after* the
  target has been merged (needs testing).  Added lots of comments.  Split
  dblink.merge() into 2 new functions -- .walktree() and .mergeme().
  Cleaned/optimized merging a good deal.  Added special "-*" USE variable to
  unset *all* USE variables defined up until that point.  
  
  18 Feb 2002; Daniel Robbins <drobbins@gentoo.org> portage.py, emerge,
  ebuild.sh : Fixed USE bug (config.reset() threw away our cumulative USE),
  streamlined turbo dep calculations by moving edb cache entry creation to
  ebuild.sh.  Started coding new dblink.merge() method that should be much
  cleaner, faster and merge symlinks safely.
 
  17 Feb 2002; Daniel Robbins <drobbins@gentoo.org> portage.py : Added
  cumulative USE variable support.  The final USE var is calculated
  cumulatively starting with make.profile, then make.conf, and then the
  environment.  Any "-foo" option in USE will turn off a previously-defined USE
  setting.  So, if you want to use the profile-default USE settings except turn
  "X" off, you add 'USE="-X"' to /etc/make.conf and that's it.  This greatly
  simplifies USE variable maintenance since developers can now easily add new
  USE variables that default to 'on'.  Simply add the USE variable and then add
  it to make.profile.  It will then be included in everyone's USE variables
  automatically unless they explicitly "-newvar" in /etc/make.conf or in the
  local environment.  This also enables easy one-shot disabling of USE
  variables.  For example, to merge xchat without GNOME support (when "gnome"
  is in your /etc/make.conf USE variable), simply type "USE="-gnome" emerge
  net-irc/xchat".  This is a lot easier than temporarily tweaking
  /etc/make.conf.
 
  17 Feb 2002: Daniel Robbins <drobbins@gentoo.org> emerge : Added a quick hack
  to cache ebuild dependency info using extended attributes on XFS filesystems.
  Gives a factor of 10 speedup for dependency calculations.  Will look into a
  generic caching solution that should offer similar performance increases on
  all filesystems.  Note: the fact that this hack is on CVS means that emerge
  is currently in a hyper-experimental state and shouldn't be used right now.
 
  16 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge : added support for 'emerge
  cat/pkg-version' instead of always having to require 'emerge cat/pkg'
  
  15 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge : reimplemented the display
  of cleaned packages to clearly show all versions that are about to be removed
  and which versions are going to stay  

  13 Feb 2002; D.Robbins <drobbins@gentoo.org> emerge :
  added --emptytree option

  13 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge, portage.py :
  fixed little bug where emerge --clean rsync wasn't correctly handled anymore
  implemented all new functionalities of emerge --clean, this adds --slots,
  --versions and --all options together with world and system modes

  12 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge, portage.py :
  changed emerge --zap to emerge --clean
  removed parts of the already implemented slots functionality to be able to
  fall back to a more flexible implementation. Binary compatible slots will now
  mostly influence emerge during the --clean operation

  12 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added fallback check in case UNMERGE_DELAY hasn't been defined in
  make.globals or make.conf

*portage 1.8.9_pre8 (18 Feb 2002)

  12 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  changed the rebuild code to use depgraph instead, dramatically reducing code
  duplication

  11 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  changed indentation of a code part that wasn't at the right level. It got the
  count of the non slot packages during --zap completely wrong

*portage 1.8.9_pre7 (11 Feb 2002)

  11 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  fixed bug in packagetree.dep_match() where a ~ dependency is returned as a
  string instead of as a list
  
  11 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  - removed support for --all and world in 'emerge --unmerge', by default now
    all matching packages are removed since with the new slots functionality
    old package versions should not exists anymore
  - colored package name red too when a blocking package is found during
    pretend operation
  - changed emerge invocation arguments to be in a new universal interface
    format this has been decided to be :
	'emerge --action --option --option [packageset]'
	some features however don't respect this, but that's since they are not
	package installation related and are easier to use as straight commands
	eg: emerge rsync
  - added UNMERGE_DELAY var to make.globals and support it in emerge to obtain
    the number of seconds to wait
  - support for NOCOLOR="yes" as wel as NOCOLOR="true"
  - major speedups for emerge -search
  - added formatted package descriptions of the matches from emerge --search
    that nicely wrap at 80 chars
  - rewrote retrieval of package descriptions to support descriptions that are
    specified on multiple lines
  - added support for 'noslot' to --zap, --update and --rebuild
  
  11 Feb 2002; G.Bevin <gbevin@gentoo.org> sandbox.c, libsandbox.c :
  added checks to see if the files where information is written to are really
  regular files and not symlinks

*portage 1.8.9_pre6 (10 Feb 2002)

  10 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added support for 'emerge --unmerge world' which removes all old package
  versions from the system
  made 'emerge --unmerge' take binary compatibility slots into account, this
  prevents that packages with different versions but also different slots, are
  being unmerged
  added support for "--verbose" in "emerge rebuild" and "emerge world" to
  provide details about packages that aren't in the local tree anymore and to
  notify the user about which packages don't support slots

  9 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added support for the rebuild mode which rebuilds all the packages on your
  system for which a corresponding package could be found in to portage tree

  9 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  renamed getEbuildPaths() or vartree to getebuildpaths()
  fixed bug in the merging of binary packages

  7 Feb 2002; G.Bevin <gbevin@gentoo.org> xpack.py :
  added additional argument to tbz2.getfile() which allows default content to
  be provided when the requested file couldn't be found in the tbz2 archive

  7 Feb 2002; G.Bevin <gbevin@gentoo.org> ebuild.sh :
  added SLOT information as the third entry in the temporary deps file that is
  generated during ebuild depend,
  
  7 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  obtain SLOT information from the deps file instead of using the slotgrab()
  function, removed slotgrab() function, updated some comments

  7 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added SLOT information to the generated edepend var for binary packages

*portage 1.8.9_pre5 (6 Feb 2002)

  6 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  fixed bugs where the old instance wasn't unmerged correctly if slots are
  identical, but ebuild version numbers not

  6 Feb 2002; Grant Goodyear <g2boojum@gentoo.org> cnf/make.conf :
  Copied proxy lines from make.globals (bug 431).

  6 Feb 2002; Vitaly Kushneriuk <vitaly@gentoo.org> portage.py :
  added missing SLOT param to merge(...).
  
*portage 1.8.9_pre4 (6 Feb 2002)

  6 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  fixed some bugs in the handling of PROVIDES and virtual packages together
  with slots, they used code that wasn't upudated to the new dblink constructor
  virtuals now use "" as slot, resulting in normally to same behaviour as what
  has been done before.
  
  5 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  sorted the packages to unmerge since this makes package names with revision
  endings appear before plain version numbers. This makes the unmerge code
  first remove the old and non slot aware packages before removing the newer
  alternative which is in fact exactly the same apart from the revision
  identifier.

*portage 1.8.9_pre3 (5 Feb 2002)

  5 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  only let the backward compatibility algorithm kick in during unmerge since
  it's impossible to correctly detect is in general.

*portage 1.8.9_pre2 (5 Feb 2002)

  5 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  fixed bug in the backward compatibility algorithm

*portage 1.8.9_pre1 (5 Feb 2002)

  4 Feb 2002; G.Bevin <gbevin@gentoo.org> ebuild.sh, emerge, portage.py :
  added binary compatibility slots, this also contains additional code to keep
  the unmerging of packages backwards compatible.
  
  4 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  added back support for the "ebuild help" command which seems to have
  disappeared somewhere along the updates
  
  4 Feb 2002; G.Bevin <gbevin@gentoo.org> make.conf, make.globals :
  added description and default entry for the imlib USE variable
  added flag to prozilla to disable prozilla's waiting for a user's keypress
  when a failure occurs
  
  4 Feb 2002; G.Bevin <gbevin@gentoo.org> output.py :
  bugfix, write read() function instead of red(), doh !
  
  4 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge, portage.py :
  implemented the ! dependency which prevents incompatible packages to be
  installed on the same system at the same time

  4 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  most emerge invocation options now have alternative short flags
  
  4 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  emerge now doesn't unmerge the last version of an installed version by
  default anymore, to really remove all instanced of packages the --all flag
  has to be used, the --safe flag is deprecated
  
  3 Feb 2002; G.Bevin <gbevin@gentoo.org> output.py, emerge,make.globals :
  all output can now be turned to black and white by using the functions in 
  output.py, this determines the mode by checking to NOCOLOR variable in
  make.conf or make.globals

  3 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  made it possible to run emerge --help and --search as non root

*portage 1.8.8-r1 (1 Feb 2002)

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py, ebuild.sh, ebuild.5 :
  added support for a pkg_setup() function which is executed before anything
  else and can be typically used for package configuration actions or required
  system checks

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  implemented the noauto MAINTAINER flags for all relevant ebuild commands

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  make env-update disregard backup files
  
  1 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added --pretend support instead of interactively asking to proceed,
  also added a delay before unmerging though to be sure

*portage 1.8.8 (1 Feb 2002)

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added --safe switch to complement the --unmerge option

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  rewrote the packagename without category support to also graceously handle
  deps specifiers at the beginning, this shouldn't be used in the ebuilds, but
  are very handy when using emerge --unmerge

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added emerge --unmerge support

  1 Feb 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  added packagename without category support in the dep_match function

*portage 1.8.7 (30 Jan 2002)

  30 Jan 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  integrated and slightly adapted Brent Rahn's code to support package names
  without category

  30 Jan 2002; G.Bevin <gbevin@gentoo.org> ebuild.sh :
  integrated and fixed Azarah's patch to fix the wrongly generated archive size
  in the digests

*portage 1.8.6-r3 (28 Jan 2002)

  28 Jan 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  disabled warnings about non existant config file paths

  28 Jan 2002; G.Bevin <gbevin@gentoo.org> emerge :
  added verwilst pkgsearch code, which was turned into a seperate class and
  refactored for clarity and execution speed

  28 Jan 2002; G.Bevin <gbevin@gentoo.org> portage.py :
  renamed _xxx vars to _prepart in Vitaly's code addition

*portage 1.8.6-r2 (27 Jan 2002)

  24 Jan 2002; Vitaly Kushneriuk <vitaly@gentoo.org> portage.py :
  Fixed version compare code Also added test script to test future versions.

*portage 1.8.6-r1 (24 Jan 2002)

  24 Jan 2002; Karl Trygve Kalleberg <karltk@gentoo.org> dojar:
  Fixed typos.
  
*portage 1.8.6 (23 Jan 2002)

  22 Jan 2002; G.Bevin <gbevin@gentoo.org> libsandbox.c :
  added an additional check for SANDBOX_ON to optimize the speed in the execvp
  function call. Also removed error messages being printed when the PATH var
  isn't set.
  
  20 Jan 2002; Karl Trygve Kalleberg <karltk@gentoo.org> dojar :
  added dojar shell command as a java JAR handler

  17 Jan 2002; Daniel Robbins <drobbins@gentoo.org> :
  The package chosen by "emerge sys-apps/shadow" now matches that chosen in an
  emerge update or emerge system.  I forgot to add some "*" dep code to the
  dep_nomatch() method; this is now fixed.

*portage 1.8.5 (13 Jan 2002)

  13 Jan 2002; G.Bevin <gbevin@gentoo.org> ebuilds.sh, portage.py:
  added fine grained maintainer settings

*portage 1.8.4 (13 Jan 2002)

  12 Jan 2002; Daniel Robbins <drobbins@gentoo.org> :
  "emerge sys-apps/bash/" now works. (trailing "/" stripped to make
  tab-completion users happy)  This fixes bug #119

  12 Jan 2002; Daniel Robbins <drobbins@gentoo.org> :
  Portage should no longer bomb out if the current working directory doesn't
  exist (has been deleted from underneath).
  
  12 Jan 2002; Daniel Robbins <drobbins@gentoo.org> :
  added "--world" option for "emerge update".   This tells Portage to update
  the base system *as well as* upgrade any packages that are currently
  installed but have new versions available.  This is your standard full system
  update command.  This fixes bug #122

  12 Jan 2002; Daniel Robbins <drobbins@gentoo.org> :
  Added an expandpath() cache which speeds up merging dramatically.

*portage 1.8.3 (11 Jan 2002)

  11 Jan 2002; Mikael Hallendal <hallski@gentoo.org> ebuild.sh:
  added functions econf and einstall. Also made src_compile having a default
  implementation.

*portage 1.8.2 (07 Jan 2002)

  07 Jan 2002; G.Bevin <gbevin@gentoo.org> :
  sandbox included in portage
	
*portage 1.8.1 (30 Dec 2001)

  29 Dec 2001; Daniel Robbins <drobbins@gentoo.org> :
  "emerge update" is now functional!  Although the algorithm really should be
  sound, it is still considered in testing since we may need to tweak some
  dependencies.

  27 Dec 2001; Daniel Robbins <drobbins@gentoo.org> :
  Removed objprelink from the default USE variable.

*portage 1.8.0 (22 Dec 2001)

  22 Dec 2001; Daniel Robbins <drobbins@gentoo.org> :
  I messed up the "transparent .so library" update.  Included is the correct
  fix, which seems to allow glibc to update on my system without any tricks.
  I just merged a new glibc while in X, without using any of glibc's old
  pkg_postinst/pkg_preinst hacks.
  
  21 Dec 2001; Daniel Robbins <drobbins@gentoo.org> make.defaults.5, make.conf.5 :
  Moved make.defaults.5 to make.conf.5 and updated contents.

*portage 1.7.8 (21 Dec 2001)

  21 Dec 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  ebuild install doesn't throw away the compile directory if ebuild has been
  changed and MAINTAINER is set; we now use mv -f to move files into location
  on the filesystem, making our library install method even more robust. It
  should now be totally safe to  upgrade glibc while in X and playing music
  with xmms and surfing the Web and compiling 20 applications at once :)

* portage 1.7.7 (14 Dec 2001)

  14 Dec 2001; Aron Griffis <agriffis@gentoo.org>: portage.py :
  movefile() now unlink()s the destination file first which solves shared
  library install problems.

* portage 1.7.6 (13 Dec 2001)

  10 Dec 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  env_update() now generates an /etc/csh.env file in csh shell format.

* portage 1.7.5 (13 Dec 2001)

  10 Dec 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  added a little fix so a ~ dep isn't satisfied by a *much* later installed
  version; i.e. ~media-libs/freetype-1.3.1 satisfied by
  media-libs/freetype-2.0.5 being installed.
  
  30 Nov 2001; Daniel Robbins <drobbins@gentoo.org> ebuild :
  added a KeyboardInterrupt handler so ^C'ing a running ebuild process doesn't
  produce a Python traceback.

* portage 1.7.4 (29 Nov 2001)

  29 Nov 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  removed an unnecessary quirk in the code preventing virtual packages from
  being in any other category but "virtual".
  
  25 Nov 2001; Daniel Robbins <drobbins@gentoo.org> emerge :
  info file detection code has been improved.  

* portage 1.7.3 (20 Nov 2001)

  20 Nov 2001; Daniel Robbins <drobbins@gentoo.org> pdb, pdb.cgi, xpak :
  used /usr/bin/python instead of /usr/bin/spython.  Fixed.

* portage 1.7.2 (13 Nov 2001)

  13 Nov 2001; Aron Griffis <agriffis@gentoo.org> :
  emake will now try to build in parallel, and if it fails, will retry in
  non-parallel mode.
  
  13 Nov 2001; Daniel Robbins <drobbins@gentoo.org> ebuild.sh :
  an ebuild that used an archive with a name that was part of another archive
  would cause Portage to mess up the digest check.  No longer.

  31 Oct 2001; Donny Davies <woodchip@gentoo.org> make.conf, make.globals :
  comments about merging the fetch programs before trying to use them.

* portage 1.7.1 (30 Oct 2001)

  30 Oct 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  I accidentally broke "=" deps by being sloppy when I added "*" deps.  Trivial
  fix applied.

* portage 1.7 (29 Oct 2001)

  29 Oct 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  strange typo fix in the empty() digraph method.

* portage 1.6.12 (29 Oct 2001)

  29 Oct 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  "*" deps now implemented. "=sys/foo-1*" matches the latest 1.x version/rev of
  sys/foo, but will not match a 2.x version.

  26 Oct 2001; Daniel Robbins <drobbins@gentoo.org> portage.py :
  various new categories added.

Portage 1.6.11, released 18 Oct 2001
====================================

	*portage.py; device nodes are now not unmerged at all.


Portage 1.6.10, released 18 Oct 2001 
===================================

	*ebuild.sh: A and AA fix; now any A="foo" lines in the ebuild are ignored,
	allowing ebuilds with them to continue working.
	
	*portage.py: remove gnome-apps, gnome-office, gnome-libs, add gnome-extra
	categories.

	*ebuild.sh, portage.py: You can now use USE variables in SRC_URI to
	conditionally include archives.  In MAINTAINER mode, all archives are
	automatically included so that maintainers can check SRC_URIs and also
	generate complete digests.  A new file-based DEPEND and RDEPEND-passing
	mechanism has been added.
	
	*ebuild.sh Now adds filesize to the digest files

Portage 1.6.9, released 15 Sep 2001
===================================

	*portage.py
	unmerge() now does not touch device nodes.  Unlinking them or touching them
	in any way is bad practice.


Portage 1.6.8, released 12 Sep 2001
===================================

	*portage.py
	movefile() will now unlink() destfile if it is a symlink.  Should fix 
	problems where file gets created at symlink target rather than replacing
	the symlink.

	*queryhost.sh (agriffis)
	Parallel pinging and other fixes.

Portage 1.6.7, released 05 Sep 2001
===================================

	*portage.py
	(last-minute fix)
	CONFIG_PROTECT unmerge protection is now observed for symlinks, fifos and
	device nodes.
	
	*portage.py
	Fixes for unmerging CONFIG_PROTECTed files.  Protected files are now *not*
	unlinked from the filesystem.  Messier but safer, and simplifies package
	upgrades.

	*emerge
	Emerge output cleanups for GNU info directory generation.  New --verbose
	mode; new CONFIG_PROTECT scanning feature to let people know when there are
	config files to be updated.  New "--help config" docs to explain how to
	do it.

Portage 1.6.6, released 01 Sep 2001
====================================

	*portage.py
	Upgraded directory merging over existing objects.  Existing symlinks that
	point to existing directories will be kept and used as is; directories will
	be used as-is; any other objects (broken symlinks, files) will be copied
	to origfilename.backup and a ne directory will be created in its place.

Portage 1.6.5, released 31 Aug 2001
====================================
	
	*emerge 
	Fixes for handling multiple ebuilds, packages and/or dependencies on
	the command-line.

	*portage.py 
	An optimization to the digraph class so that the firstzero() method finds
	matches in close to the order that keys were added to the digraph.
