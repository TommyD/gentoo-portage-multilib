INSTALL    	= @INSTALL@
INSTALL_PY 	= @INSTALL_DATA@ -D
PORTAGE_PYM	= @PORTAGE_BASE@/pym
DESTDIR 	= @DESTDIR@
INSTALL_PYTHON_SOURCES = @INSTALL_PYTHON_SOURCES@

compile:
	python -c 'import compileall; compileall.compile_dir(".")'
clean:
	find . -type f -name '*.pyc' -exec rm {} \;

install:	compile
	$(INSTALL) -d -m644 $(DESTDIR)/$(PORTAGE_PYM)
	test -z "$(INSTALL_PYTHON_SOURCES)" || \
		find . -type f -name '*.py' -exec $(INSTALL_PY) {} $(DESTDIR)/$(PORTAGE_PYM)/{} \;
	find . -type f -name '*.pyc' -exec $(INSTALL_PY) {} $(DESTDIR)/$(PORTAGE_PYM)/{} \;

all: 	compile

distdir:
	find  -type f -name '*.py' -exec $(INSTALL) -D {} $(distdir)/{} \;
		
.PHONY:	distdir install clean
